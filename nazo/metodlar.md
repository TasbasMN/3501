## Verilerin Ön İşlenmesi

Laboratuvar kaynaklı, yüksek kalite miRNA-mRNA bağlanma verileri Helwak vd. (2013) ve Moore vd. (2014) makalelerinden temin edilecektir. Bu temin edilen ham veriler, tahmin modeli eğitmek için kullanılmadan önce, tahminde kullanılmaya uygun bir forma getirilmesi gerekmektedir.

Makalelerin sağladığı veri özünde aynı olmasına rağmen, farklı formatlarda sunulduğu için öncelikle veriler standardize edilecektir. Verilerin standardize edilmesi sürecinin sonunda, her miRNA-mRNA etkileşimine dair şu bilgilerin elde edilmesi amaçlanmaktadır; mRNA adı, olgun mRNA sekansı, mRNA'nın miRNA ile etkileşen kısmı (miRNA recognition element, MRE) koordinatları, MRE sekansı, etkileşimde rol oynayan mRNA bazı sayısı, miRNA adı, miRNA sekansı, miRNA sekansının MRE ile etkileşime giren kısmının koordinatları ve sekansı ve çekirdek (seed) tipi.

Bu standardizasyon tamamlandıktan sonra, her giri için mRNA ve miRNA sekansları, ENSEMBL (Harrison et al., 2023) veri tabanından elde edeceğimiz sekanslarla karşılaştırılacak ve uyuşmazlık olması durumunda o giriler incelenmek üzere kenara ayrılacaktır. Ayrıca MRE bölgesinin, temin edilen sekansın sınırlarında çıkması ihtimaline karşılık, her girideki mRNA dilimlerinin her iki ucu da 30'ar nükleotit uzatılacaktır. Elimizdeki sekans verileri 5'-3' yönlü cDNA formunda olduğu için bu çalışmadaki bütün sekanslar bu formda kullanmak üzere standardize edilecek, böylelikle olası karışıklıkların önüne geçilecektir.

Deneysel metodların sınırlamaları nedeniyle MRE bölgesinin tam koordinatı elde edilememektedir, ancak MRE bölgesini içerdiğinden emin olunan bir koordinat aralığı temin edilmektedir. Bu koordinat aralığında MRE'nin tam olarak hangi bölgeye düştüğünün tahmin edilmesine gerek vardır. Yapılan literatür araştırması doğrultusunda ViennaRNA (Lorenz et al., 2011) adlı biyoenformatik araçları paketinin içerisinde yer alan RNADuplex adlı programın kullanımı uygun görülmüştür. Bu kararın ardında yatan en önemli sebeplerin biri, RNA literatüründe, özellikle miRNA literatüründe ViennaRNA araçlarının yaygın bir şekilde kullanılmış olmasıdır. Paket içerisindeki farklı araçlar, farklı ihtiyaçlara hizmet etmekle birlikte, RNADuplex'in sağladığı çıktı formatı, bizim öznitelik mühendisliği sürecimiz için uygun ve kolay işlenebilir niteliktedir.

RNADuplex, kendisine verilen iki adet mRNA sekansının termodinamik açıdan en kararlı hangi konformasyonda bağlanacağını hesaplayıp kullanıcıya şu verileri sunar; tam olarak hangi nükleotitlerin bağlanmada görev aldığı, bağlanmanın şematik çizimi ve hesaplanan gibbs serbest enerji değeri. RNAduplex çıktıları kullanılarak, ham verideki her giri için, en olası MRE bölgesi hesaplanacaktır. Bu hesaplama ile birlikte elimizdeki her bir miRNA-mRNA etkileşimi için MRE pozisyonları ve o etkileşimlerin kaç nükleotitten oluştuğu elde edilecektir. RNADuplex, farklı parametrelerle analizin doğasının değiştirilmesine imkan vermektedir. Yapılan ön deneylerde programın varsayılan parametrelerinin, bu proje uygulamaları için uygun olduğu tespit edilmiştir.

## Pozitif ve negatif veriseti oluşturulması

Ön hazırlığı bitmiş veriseti, çeşitli filtrelemele tabi tutularak pozitif ve negatif veri setleri hazırlanacaktır. Pozitif veri seti için öncelikle ön hazırlığı bitmiş veri detaylıca incelenip, teorik uyuşmazlıklar varsa filtrelenecektir. Örneğin, çekirdek tipi 6mer, 7mer ve 8mer görünmesine rağmen çekirdek bölgesinde bahsedilenden az sayıda baz çifti içeren giriler, ya da etkileşime giren baz çifti sayısı çok az olan giriler filtrelenecektir. Veri setinin yapısına göre bu kısımdaki yaklaşım değişebilir. Ayrıca, tahmin edilen gibbs enerjisi -5 kcal/mol'den yüksek olan giriler, yapıları stabil olmayacağı için filtrelenecektir. 

Oluşturulan toplam pozitif giri sayısına eşit miktarda negatif giri üretilmek için aşağıdaki adımlar uygulanacaktır. Pozitif ve negatif giri sayısının aynı olması dengeli bir veri seti oluşturmamızı sağlayacak ve modelin her iki sınıfı eşit şekilde öğrenmesine yardımcı olacaktır. Bu yaklaşım, sınıflandırma problemlerinde yaygın olarak kullanılan bir yöntemdir ve modelin performansına olumlu etkisi olması beklenmektedir.

Yaklaşımımız sekans bazlı olduğu için, negatif veri seti oluşturmanın en kritik adımı, her girdideki MRE'ye bağlanmayacak bir miRNA sekansının üretilip eklenmesi olacaktır. Yapılan kapsamlı literatür taraması sonucunda, nükleotit sekansı için negatif veri seti hazırlamaya yönelik çeşitli yaklaşımlar değerlendirilmiştir. Bu değerlendirme sonucunda, Klimentova et al. (2022)'de önerilen negatif veri seti üretme metodunun modifiye edilmiş bir versiyonunun kullanılmasına karar verilmiştir. Bu yaklaşımda, elimizdeki tüm miRNA sekansları için birbirleri arasındaki Levenshtein mesafesi hesaplanacak ve negatif sekans seçimi bu mesafeye göre yapılacaktır. Levenshtein mesafesinin tercih edilmesinin en önemli sebebi, biyoenformatik uygulamalarda yaygın olarak kullanılması ve etkinliğinin kanıtlanmış olmasıdır (Berger et al., 2021).

Levenshtein mesafesi, iki sekans arasındaki minimum düzenleme mesafesini ölçen bir algoritmadır. Bu mesafe, bir sekansı diğerine dönüştürmek için gereken ekleme, silme veya değiştirme işlemlerinin minimum sayısını ifade eder. Bu mesafe ölçeği, nükleotit değişimlerini ölçtüğü için miRNA-mRNA etkileşimlerini modellemede uygun görünmektedir. Örneğin, bir guanin-sitozin baz çiftinde sitozine düşen herhangi bir mutasyon, Watson-Crick bağlanmasını bozacağından, bu değişimin Levenshtein mesafesi ile tespit edilmesi mümkün olacaktır. Böylece birbiri arasında maksimum Levenshtein mesafesi olan iki miRNA, birbirlerinden davranış olarak oldukça farklı çıkacaktır. Bu yaklaşım, biyolojik olarak anlamlı ve hesaplama açısından verimli bir negatif veri seti oluşturmamızı sağlayacaktır. Yapılan ön deneylerde de bu yaklaşımın çalıştığını gözlemlediğimiz için, metodun uygulanabilirliğine güveniyoruz.

Bağlandığı bilinen miRNA sekansının yerine konacak negatif sekanslar hesaplandıktan sonra, MRE bölgesini içeren mRNA sekansı & negatif miRNA sekansı ikilileri RNADuplex programına gönderilip çıktıları alınacaktır. Son adım olarak, negatif ve pozitif verisetleri ortak bir verisetinde toplanıp pozitif veriler 1, negatif veriler ise 0 kullanarak etiketlenecektir. 

# Öznitelik mühendisliği


RNADuplex programı, verilen iki RNA molekülünün etkileşim şemasını nokta parantez notasyonu (dot bracket notation) kullanarak resmeder. Bu notasyonda birbiriyle WC etkileşiminde bulunan nükleotitler parantezle, herhangi bir WC etkileşiminde bulunmayan nükleotitler ise nokta ile resmedilir. miRNA ve mRNA için ayrı ayrı elde edilen nokta parantez notasyonları, kolaylık açısından 1'ler ve 0'lar kullanan bir gösterime çevrilip hizalama dizisi (alignment_string) olarak kullanılacaktır. 1'ler WC etkileşimini temsil ederken 0'lar boşta kalan nükleotitleri temsil eder. 

Her giri için, bu hizalama dizisi temel alınarak toplam baz çifti (base pair) sayısı, çekirdek (seed) bölgesindeki baz çifti sayısı, çekirdek bölgesindeki baz çiftlerinin diziliminden elde edilen çekirdek tipi (seed_type) elde edilecektir. Ayrıca, ham verisetinden gelen baz çifti sayısı ve çekirdek baz çifti sayısı değerleri ile RNADuplex ile hesaplanan baz çifti değerlerinin farkları da birer öznitelik olarak değerlendirilecektir.

Her girideki olgun mRNA'nın adı ve MRE koordinatları kullanılarak etkileşimde bulunan bölgenin sekans bilgisi (mre_region), olgun mRNA MRE başlangıç (mre_start) ve bitiş (mre_end) koordinatları elde edilecektir.

Her giri miRNA'nın adı kullanılarak o miRNA'lara dair şu öznitelikler verisetine eklenecektir; miRNA sekans uzunluğu ve TargetScan'den (Agarwal et al., 2015) elde edilen, o miRNA'nın evrimsel korunumunu simgeleyen sayısal değer.

Hedef yoğunluğu (target abundance, TA) değeri, Garcia et al. (2011) tarafından ortaya konan ve  Agarwal et al. (2015) tarafından her miRNA için hesaplanan, o miRNA'nın bütün 3' UTR'larda olan bilinen etkileşim yerlerini sembolize eden bir değerdir. Çekirdek bağlanma stabilitesi (seed pairing stability, SBS) değeri de yine Garcia et al. (2011) tarafından ortaya konan ve Agarwal et al. (2015) tarafından olası her miRNA çekirdek sekansı için hesaplanmış, o çekirdeğin bağlantı sırasındaki termodinamik stabilitesini simgeleyen bir değerdir. Bu sayısal değerler de öznitelik olarak değerlendirilecektir.

Çekirdek bölgesinin yapısını sembolize eden 6mer, 7mer, 8mer, 8mer-1-mismatch gibi öznitelikler de one hot encoding şeması kullanılarak eklenecektir. Bu öznitelikler tasarlanırken, Steinkraus et al. (2016) makalesi 1. figür temel alınacaktır.

AU içeriği, miRNA bağlanmasında ve miRNA-mRNA kompleksinin stabilitesinde önemli bir rol maktadır (Grimson et al., 2007). MRE bölgesinin ve 30'ar nükleotit çevresindeki bölgenin AU içeriği hesaplanarak yeni birer öznitelik olarak eklenecektir. Bu da bize bağlantı bölgesinin yakın ve uzak çevresindeki AU oranı hakkında fikir verecektir. 

Bir MRE'nin yakın çevresinde aynı miRNA'nın başka bir MRE'si olma durumu, bu iki MRE'nin sinerjik çalışıp etkilerinin artmasına sebep olur (Sætrom et al., 2007). Bu yüzden, her MRE için, eğer 13-35 nükleotit mesafede aynı miRNA'nın başka bir MRE'si tespit edilirse bu veri ikili (binary) bir şekilde kodlanıp öznitelik olarak kullanılacaktır. 13-35 değerleri de yine Sætrom vd. (2007) kaynak alınarak belirlenmiştir.

MRE'nin, olgun mRNA transkriptinin üstündeki lokalizasyonu da gen represyonu açısından önemli bir veridir (Grimson et al., 2007). Aynı makalede, olgun mRNA'nın herhangi bir ucuna doğru olan MRE'lerin, ortasında olan MRE'lere göre daha etkili olduğu görüldüğü için, MRE'nin, olgun mRNA üzerindeki görece pozisyonu da ek bir öznitelik olarak kullanılacaktır.

## Ekstrem Gradyan Arttırma (Extreme Gradient Boosting, XGBoost) modeli eğitilmesi

Hazırlanan veriseti, XGBoost algoritmasına verilerek eğitim süreci gerçekleştirilecektir. Veri setinin %15'i bağımsız test seti olarak ayrılacak, kalan %85'lik kısım eğitim ve validasyon için kullanılacaktır. Eğitim ve validasyon sürecinde 5-katlı çapraz doğrulama (5-fold cross-validation) tekniği uygulanacaktır. Bu teknikte, %85'lik veri seti 5 eşit parçaya bölünecek, her seferinde 4 parça eğitim için, 1 parça validasyon için kullanılacak ve bu işlem 5 kez tekrarlanacaktır. Bu sayede, tüm veri hem eğitim hem de validasyon için kullanılmış olacak, modelin genelleme yeteneği daha iyi değerlendirilecektir. Tüm bu ayırma işlemleri uygulanırken pozitif ve negatif verilerin, gruplara eşit miktarda dağıldığından emin olmak için katmanlaştırma (stratify) yaklaşımından faydalanılacaktır. Bu stratejinin kullanılması, modelin tüm veri alt kümelerinde dengeli bir şekilde değerlendirilmesini ve genel veri setini temsil eden sonuçlar elde edilmesini sağlayacaktır. Çapraz doğrulama mertebesi ve bağımsız test verisi yüzdesi, çıkacak sonuçlara göre değiştirilip yeni deneyler kurgulanabilir. 

Sayısal özniteliklerin sayısal değerleri, 0 ile 1 değerleri arasına ölçeklenip, çok büyük sayısal verilerin eğitimi etkilemesinin önüne geçilecektir. Ayrıca, kullanılan özniteliklerin birbirleriyle olan korelasyonları kontrol edilerek, birbirine çok yakın özniteliklerin tespiti yapılacaktır. Yine çıkan sonuca göre, gerekli hamleler yapılacaktır. AU içeriği bilgisini sağlayan özniteliklerin yüksek korelasyonlu çıkması öngörülmektedir. Sebebi ise, genomların belirli bölgelerinin benzer GC içeriğine sahip olmasından ileri gelmektedir (Pozzoli et al., 2008, Romiguier & Roux, 2017).

Birden fazla eğitim deneyi yapılarak, bu deneylerde farklı değişkenleri ve üst değişkenleri (hyperparameter) değiştirerek, yüksek performanslı bir XGBoost modeli oluşturmak hedeflenmiştir. Yapılması planlanan deneylerden bazıları şunlardır:
- Negatif verinin çekirdek tipinin 0 olarak işaretlenmesi 
- Düşük öneme sahip özniteliklerin çıkarılması
- Yüksek korelasyona sahip özniteliklerin çıkarılması
- Her özniteliğin tek tek çıkarılıp, eğitim sonuçlarının karşılaştırılması

Ayrıca, yapılan her deney için, üstdeğişken ince ayarı (hyperparameter tuning) işlemi yapılıp, eğitim oranı (learning rate) ve maksimum derinlik gibi farklı değişkenlerin model üzerindeki etkileri raporlanacaktır.

Eğitimler gerçekleştikten sonra, eğitimin detaylarını incelemek amacıyla Lundberg ve Lee (2017) tarafından geliştirilmiş SHAP (Shapley Eklemeli Açıklamalar) metodolojisi ile eğitimde kullanılan her özniteliğin, sonuç tahmin etmeye katkısı test edilecektir. Buradan alınan sonuçlara göre, özniteliklerde değişiklik yapılıp yapılmayacağı ortaya çıkacaktır. Eğer tahmine katkısı olmayan öznitelik tespit edilirse, kullanımdan vazgeçilecektir.

XGBoost algoritmasının yanı sıra, diğer popüler makine öğrenmesi algoritmaları da denenecektir. Random Forest ve Support Vector Machines (SVM) gibi farklı yaklaşımlar da değerlendirilecektir. Bu karşılaştırma, XGBoost'un gerçekten en iyi seçenek olup olmadığını anlamamıza yardımcı olacak ve belki de beklenmedik şekilde daha iyi performans gösteren bir algoritma bulmamızı sağlayacaktır. Ayrıca, farklı algoritmaların güçlü ve zayıf yönlerini anlamamıza ve problemimiz için en uygun çözümü bulmamıza yardımcı olacaktır.

Model performansını değerlendirmek için kullanılacak spesifik metrikler önceden belirlenmiştir. miRNA-mRNA etkileşim tahmini problemi için accuracy, precision, recall, F1-score ve ROC-AUC metrikleri kullanılacaktır. Bu metrikler, modelin farklı açılardan nasıl performans gösterdiğini anlamamıza yardımcı olacaktır. Verisetinin dengesiz olma ihtimaline karşılık, F1-score ve ROC-AUC gibi metrikler de dikkate alınacaktır. Bu metrikler kullanılarak farklı model versiyonları ve farklı algoritmalar karşılaştırılacak ve en iyi performans gösteren model seçilecektir. Yapılan bütün eğitim deneylerinin sonuna en performanslı model, bir dosyaya sonra tahminde kullanmak üzere kaydedilecektir.

# Kanser Mutasyonlarının Analizi

Nik-Zainal et al. (2016) çalışmasında paylaşılan 560 meme kanseri hastası mutasyonlarının her biri üzerinde uygulanması planlanan adımlar aşağıda belirtilmiştir.

## vcf dosyasının ön işlenmesi

Mutasyonların bulunduğu variant call (vcf) dosyalarındaki kromozom:pozisyon koordinatları ve mutasyon öncesi bulunan nükleotitler elimizdeki ENSEMBL kaynaklı genom ile karşılaştırılarak uyumsuz örnek çıkması durumunda sonra analiz etmek amacıyla ayrı bir dosyaya kaydedilecektir. Bir sonraki adımda verilen koordinatın bir miRNA genine düşüp düşmediği kontrol edilecektir. MiRNA genine düşmeyen mutasyonlar tip 1, miRNA genine düşen mutasyonlar tip 2 olarak sınıflandırılacaktır.

## Tip 1 mutasyonların analizi

Genomik koordinatlar ve mutasyon öncesi/sonrası nükleotitler kullanılarak, mutasyon bölgesinden iki yöne doğru 30'ar nükleotitlik bölgeyi kapsayan yabanıl ve mutasyona uğramış sekans dizileri elde edilecektir. Elimizdeki her mutasyon için, elimizdeki her bilinen insan miRNA'sı için sekans ikilileri hazırlanıp bu ikililer RNADuplex adlı programa gönderilip sonuçlar alınacaktır. Aynı işlem hem yabanıl, hem de mutasyona uğramış sekans için uygulanacaktır. RNADuplex, gönderilen 61 nükleotitlik bölge içerisinde o miRNA'nın bağlanabileceği en stabil koordinatları ve o bağlantının enerjisi ve nokta parantez şemasını bildirecektir. Sonra her mutasyon için, en iyi bağlanmayı sağlayan kısmının MRE sekansı elde edilecektir. Bu MRE sekansı ve RNADuplex çıktıları kullanarak, daha önce detaylıca açıklanan öznitelik mühendisliği işlemleri uygulanıp veriseti, tahmin modelimiz ile uygun hale getirilecektir. Elimizdeki her miRNA-mRNA ikilisi adayı, tahmin modelimiz kullanılarak bağlanma olur-bağlanma olmaz diye sınıflandırılacaktır. Bu işlem sonucunda elimizde miRNA-mRNA ikilisi adayları ve onların etkileşim kurma olasılığı verisi (0-1 arasında) olacaktır. Bu kısımda, farklı eşikler değerlendirilerek, en uygun karar eşiği belirlenecektir. İlk olarak 0.5 eşiği denenip elde edilen olasılığı eğer 0.5'in altında ise bağlanma yoktur, üstünde ise bağlanma vardır kabul edilecektir.

## Tip 2 mutasyonların analizi

Tip 2 mutasyonlar, mRNA yerine miRNA sekansında değişime sebep olduğu için farklı bir yaklaşıma ihtiyaç vardır. Bu durumlarda uygulanması planlanan genel adımlar aşağıda belirtilmiştir. 

Her miRNA'nın mutasyon öncesi ve sonrası sekansları hazırlanacaktır. Bu sekanslar kullanılarak, hücre içinde ifade edildiği bilinen bütün RNA dizileri ile eşleştirilecektir. Mutasyon öncesi ve sonrası ikililer RNADuplex kullanılarak işlemden geçirilecektir. RNADuplex sonuçları kullanılarak, yukarıda detayları verilen öznitelik mühendisliği adımları uygulanıp veri, model ile tahmine uygun hale getirilecektir. Burada çok önemli bir detay bulunmaktadır. Modelin eğitiminde kullanılan özniteliklerden başka tip 2 mutasyonlara özel öznitelik eklememiz mümkün değildir çünkü model eğitiminde kullanılmayan bir özniteliğin tahmin aşamasında kullanılması, modelin performansını olumsuz etkileyebilir ve hatta modelin çalışmasını engelleyebilir. Bu nedenle, tip 2 mutasyonlar için yapılacak analizlerde, mevcut model öznitelikleri ile uyumlu ve karşılaştırılabilir veriler üretilmesine özen gösterilecektir.

Bu temel adımlar, tip 2 mutasyon analizimizin iskeletini oluşturacaktır. Buradan elde edilen çıktılar ile, tip 1 mutasyonların analizinden çıkan çıktılar aynı formatta olacağı için, akışta bir sonraki basamağa geçmeden önce bu veriler aynı veritabanında toplanıp bir sonraki basamağa geçilecektir.

## Tahmin sonuçlarının anlamlandırılması

Bir önceki basamakta üretilen tip 1 ve tip 2 miRNA-mRNA etkileşim adayları, vcf dosyasındaki her mutasyon için kendi içinde gruplandırılıp mutasyonun bağlanma olasılığına olan etkisi hesaplanacaktır. Bunun için de, model tarafından hesaplanan olasılıkların farkı alınacaktır. Mutasyonun etkileşim dinamiğini değiştirmediği hesaplanan girdiler filtrelenip geriye mutasyonun etkileşim dinamiğini değiştirdiği düşünülen miRNA-mRNA ikilileri kalacaktır. Eğer mutasyon öncesi miRNA etkileşimi yoksa ve mutasyon sayesinde bu etkileşim oluştu ise, o mutasyona fonksiyon kazanımı (gain of function, GoF) mutasyon etiketi, tam tersine ise fonksiyon kaybı (loss of function, LoF) mutasyon etiketi atanacaktır. Böylelikle hangi mutasyonun, hangi miRNA'nın etkileşim dinamiklerini değiştirdiğinin bulunması beklenmektedir.

Elimizdeki her anlamlı mutasyon-miRNA-mRNA girdisi için, ileri analizde gereken öznitelikler tekrardan hesaplanacaktır. Bunun için, mRNA'yı kodlayan gen isimleri ve o genler hakkında literatürden toplanan muhtelif detaylar, miRNA isimleri ve o miRNA'lar hakkında literatürden toplanan muhtelif detaylar analiz verisetine eklenecektir. Ayrıca her giriden sorumlu olan mutasyon, ait olduğu mutasyon imzası ile eşleştirilecektir. Burada elde edilen anlamlı verinin doğasına göre farklı keşifsel veri analizi teknikleri kurgulanacak ve uygulanacaktır. 